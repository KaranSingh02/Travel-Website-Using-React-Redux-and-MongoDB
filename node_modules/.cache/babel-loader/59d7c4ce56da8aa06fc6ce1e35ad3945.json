{"ast":null,"code":"import { app } from \"./app.js\"; //import { items } from \"./mongodb\";\n\nimport { UserPasswordAuthProviderClient, UserPasswordCredential } from \"mongodb-stitch-browser-sdk\"; // const { UserPasswordAuthProviderClient } = Stitch;\n\nconst emailPasswordClient = app.auth.getProviderClient(UserPasswordAuthProviderClient.factory);\nexport async function registerUser(email, password) {\n  //allow users to log in with email and password\n  await emailPasswordClient.registerWithEmail(email, password).then(() => window.location.href = '/login').catch(err => alert(\"Error registering new user:\", err));\n}\nexport async function loginUser(email, password) {\n  const credential = new UserPasswordCredential(email, password); //var curruser = getCurrentUser();\n  //var result = await items.find({}).toArray();\n\n  await app.auth.loginWithCredential(credential) // Returns a promise that resolves to the authenticated user\n  .then(user => {\n    // var curruser = getCurrentUser();\n    // var ispresent = result.some(item => item.owner_id === curruser.id);\n    //  if(ispresent){\n    //     window.location.href = '/'\n    //  }\n    //  else{\n    //     window.location.href = '/profile'\n    // }\n    window.location.href = '/home';\n  }).catch(err => alert(`login failed with error: ${err}`));\n}\nexport function hasLoggedInUser() {\n  // Check if there is currently a logged in user  \n  //console.log('from has logged in auth :-'+app.auth.isLoggedIn)\n  return app.auth.isLoggedIn;\n}\nexport function getCurrentUser() {\n  // Return the user object of the currently logged in user\n  return app.auth.isLoggedIn ? app.auth.user : null;\n}\nexport async function logoutCurrentUser() {\n  // Logout the currently logged in user\n  const user = getCurrentUser();\n  await app.auth.logoutUserWithId(user.id).then(() => window.location.href = '/register');\n}","map":{"version":3,"sources":["E:/React/My-Website-EVS/src/Stitch/authentication.js"],"names":["app","UserPasswordAuthProviderClient","UserPasswordCredential","emailPasswordClient","auth","getProviderClient","factory","registerUser","email","password","registerWithEmail","then","window","location","href","catch","err","alert","loginUser","credential","loginWithCredential","user","hasLoggedInUser","isLoggedIn","getCurrentUser","logoutCurrentUser","logoutUserWithId","id"],"mappings":"AAAA,SAASA,GAAT,QAAoB,UAApB,C,CACA;;AACC,SAASC,8BAAT,EAAwCC,sBAAxC,QAAsE,4BAAtE,C,CACD;;AAEA,MAAMC,mBAAmB,GAAGH,GAAG,CAACI,IAAJ,CACvBC,iBADuB,CACLJ,8BAA8B,CAACK,OAD1B,CAA5B;AAIA,OAAO,eAAeC,YAAf,CAA4BC,KAA5B,EAAkCC,QAAlC,EAA4C;AAC/C;AACA,QAAMN,mBAAmB,CAACO,iBAApB,CAAsCF,KAAtC,EAA6CC,QAA7C,EACDE,IADC,CACI,MAAOC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,QADlC,EAEDC,KAFC,CAEKC,GAAG,IAAIC,KAAK,CAAC,6BAAD,EAAgCD,GAAhC,CAFjB,CAAN;AAGH;AAED,OAAO,eAAeE,SAAf,CAAyBV,KAAzB,EAA+BC,QAA/B,EAAyC;AAC5C,QAAMU,UAAU,GAAG,IAAIjB,sBAAJ,CAA2BM,KAA3B,EAAiCC,QAAjC,CAAnB,CAD4C,CAExC;AACA;;AACJ,QAAMT,GAAG,CAACI,IAAJ,CAASgB,mBAAT,CAA6BD,UAA7B,EACN;AADM,GAELR,IAFK,CAECU,IAAD,IACL;AACG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAT,IAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,OAAvB;AACH,GAbK,EAcLC,KAdK,CAcCC,GAAG,IAAIC,KAAK,CAAE,4BAA2BD,GAAI,EAAjC,CAdb,CAAN;AAeH;AAED,OAAO,SAASM,eAAT,GAA2B;AAChC;AACA;AACA,SAAOtB,GAAG,CAACI,IAAJ,CAASmB,UAAhB;AACD;AAED,OAAO,SAASC,cAAT,GAA0B;AAC7B;AACA,SAAOxB,GAAG,CAACI,IAAJ,CAASmB,UAAT,GAAsBvB,GAAG,CAACI,IAAJ,CAASiB,IAA/B,GAAsC,IAA7C;AACH;AAED,OAAO,eAAeI,iBAAf,GAAmC;AACtC;AAEA,QAAMJ,IAAI,GAAGG,cAAc,EAA3B;AACA,QAAMxB,GAAG,CAACI,IAAJ,CAASsB,gBAAT,CAA0BL,IAAI,CAACM,EAA/B,EAAmChB,IAAnC,CACF,MAAMC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,WAD3B,CAAN;AAGH","sourcesContent":["import { app } from \"./app.js\";\r\n//import { items } from \"./mongodb\";\r\n import { UserPasswordAuthProviderClient,UserPasswordCredential } from \"mongodb-stitch-browser-sdk\";\r\n// const { UserPasswordAuthProviderClient } = Stitch;\r\n\r\nconst emailPasswordClient = app.auth\r\n    .getProviderClient(UserPasswordAuthProviderClient.factory);\r\n\r\n\r\nexport async function registerUser(email,password) {\r\n    //allow users to log in with email and password\r\n    await emailPasswordClient.registerWithEmail(email, password)\r\n        .then(() =>  window.location.href = '/login')\r\n        .catch(err => alert(\"Error registering new user:\", err));\r\n}\r\n\r\nexport async function loginUser(email,password) {\r\n    const credential = new UserPasswordCredential(email,password);\r\n        //var curruser = getCurrentUser();\r\n        //var result = await items.find({}).toArray();\r\n    await app.auth.loginWithCredential(credential)    \r\n    // Returns a promise that resolves to the authenticated user\r\n    .then((user) => \r\n     {        \r\n        // var curruser = getCurrentUser();\r\n        // var ispresent = result.some(item => item.owner_id === curruser.id);\r\n        //  if(ispresent){\r\n        //     window.location.href = '/'\r\n        //  }\r\n        //  else{\r\n        //     window.location.href = '/profile'\r\n        // }\r\n        window.location.href = '/home'\r\n    })\r\n    .catch(err => alert(`login failed with error: ${err}`));\r\n}\r\n\r\nexport function hasLoggedInUser() {\r\n  // Check if there is currently a logged in user  \r\n  //console.log('from has logged in auth :-'+app.auth.isLoggedIn)\r\n  return app.auth.isLoggedIn;\r\n}\r\n\r\nexport function getCurrentUser() {\r\n    // Return the user object of the currently logged in user\r\n    return app.auth.isLoggedIn ? app.auth.user : null;\r\n}\r\n\r\nexport async function logoutCurrentUser() {\r\n    // Logout the currently logged in user\r\n    \r\n    const user = getCurrentUser();\r\n    await app.auth.logoutUserWithId(user.id).then(\r\n        () => window.location.href = '/register'\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}