{"ast":null,"code":"import { items } from \"./../../Stitch/mongodb\";\nimport { loginUser, registerUser, hasLoggedInUser, logoutCurrentUser, getCurrentUser } from \"./../../Stitch/authentication\";\nconst myState = {\n  check: hasLoggedInUser(),\n  currentuser: getCurrentUser(),\n  dealer: false,\n  customer: false\n};\nexport const userReducer = (state = myState, action) => {\n  switch (action.type) {\n    case 'REGISTER_USER':\n      myState.dealer = action.dealer;\n      myState.customer = action.customer;\n      const new_reg_user = {\n        \"email\": action.user_email,\n        \"isAdmin\": false,\n        \"isDealer\": action.user_dealer,\n        \"isCustomer\": action.user_customer\n      };\n      items.insertOne(new_reg_user);\n      registerUser(action.email, action.password);\n      return state;\n\n    case 'LOGIN_USER':\n      myState.check = action.isLogIn;\n      loginUser(action.email, action.password);\n      return myState;\n\n    case 'UPDATE_PROFILE':\n      //quering the user whose profile is to be updated.\n      const query = {\n        \"email\": action.user_email\n      }; //upsert when true add a new doc if the above query runs false\n\n      const options = {\n        \"upsert\": true\n      }; //the data to be updated or added\n\n      const new_user = {\n        \"owner_id\": myState.currentuser.id,\n        \"name\": action.user_name,\n        \"email\": action.user_email,\n        \"age\": action.user_age,\n        \"bio\": action.user_bio,\n        \"isAdmin\": action.user_admin,\n        \"isDealer\": action.user_dealer,\n        \"isCustomer\": action.user_customer\n      }; // if(action.user_dealer){\n      //     dealerDetails.updateOne(query, new_user, options).then(() => alert(\"User Profile Updated\"));\n      // }\n      // else{\n      //     customerDetails.updateOne(query, new_user, options).then(() => alert(\"User Profile Updated\"));\n      // }\n\n      dealerDetails.updateOne(query, new_user, options).then(() => alert(\"User Profile Updated\")); //items.insertOne(new_user).then(() => alert(\"User Profile Updated\"));\n\n      return myState;\n\n    case 'LOGOUT_USER':\n      //updating the state\n      myState.check = false;\n      myState.dealer = false;\n      myState.customer = false;\n      logoutCurrentUser();\n      return myState;\n\n    default:\n      //returning previous state\n      return state;\n  }\n};","map":{"version":3,"sources":["E:/React/My-Website-EVS/src/Redux/Reducers/addReducer.js"],"names":["items","loginUser","registerUser","hasLoggedInUser","logoutCurrentUser","getCurrentUser","myState","check","currentuser","dealer","customer","userReducer","state","action","type","new_reg_user","user_email","user_dealer","user_customer","insertOne","email","password","isLogIn","query","options","new_user","id","user_name","user_age","user_bio","user_admin","dealerDetails","updateOne","then","alert"],"mappings":"AAAA,SAAQA,KAAR,QAAoB,wBAApB;AACA,SACGC,SADH,EAEGC,YAFH,EAGGC,eAHH,EAIGC,iBAJH,EAKIC,cALJ,QAMO,+BANP;AAUA,MAAMC,OAAO,GAAG;AACZC,EAAAA,KAAK,EAAEJ,eAAe,EADV;AAEZK,EAAAA,WAAW,EAAEH,cAAc,EAFf;AAGZI,EAAAA,MAAM,EAAE,KAHI;AAIZC,EAAAA,QAAQ,EAAE;AAJE,CAAhB;AAOA,OAAO,MAAMC,WAAW,GAAI,CAACC,KAAK,GAAGN,OAAT,EAAkBO,MAAlB,KAA6B;AACrD,UAAQA,MAAM,CAACC,IAAf;AAEI,SAAK,eAAL;AACIR,MAAAA,OAAO,CAACG,MAAR,GAAiBI,MAAM,CAACJ,MAAxB;AACAH,MAAAA,OAAO,CAACI,QAAR,GAAmBG,MAAM,CAACH,QAA1B;AACA,YAAMK,YAAY,GAAG;AACjB,iBAASF,MAAM,CAACG,UADC;AAEjB,mBAAW,KAFM;AAGjB,oBAAYH,MAAM,CAACI,WAHF;AAIjB,sBAAcJ,MAAM,CAACK;AAJJ,OAArB;AAMAlB,MAAAA,KAAK,CAACmB,SAAN,CAAgBJ,YAAhB;AACAb,MAAAA,YAAY,CAACW,MAAM,CAACO,KAAR,EAAeP,MAAM,CAACQ,QAAtB,CAAZ;AACA,aAAOT,KAAP;;AAEJ,SAAK,YAAL;AACIN,MAAAA,OAAO,CAACC,KAAR,GAAgBM,MAAM,CAACS,OAAvB;AACArB,MAAAA,SAAS,CAACY,MAAM,CAACO,KAAR,EAAcP,MAAM,CAACQ,QAArB,CAAT;AACA,aAAOf,OAAP;;AAEJ,SAAK,gBAAL;AACI;AACA,YAAMiB,KAAK,GAAG;AAAE,iBAASV,MAAM,CAACG;AAAlB,OAAd,CAFJ,CAGI;;AACA,YAAMQ,OAAO,GAAG;AAAC,kBAAU;AAAX,OAAhB,CAJJ,CAKI;;AACA,YAAMC,QAAQ,GAAG;AACb,oBAAYnB,OAAO,CAACE,WAAR,CAAoBkB,EADnB;AAEb,gBAAQb,MAAM,CAACc,SAFF;AAGb,iBAASd,MAAM,CAACG,UAHH;AAIb,eAAOH,MAAM,CAACe,QAJD;AAKb,eAAOf,MAAM,CAACgB,QALD;AAMb,mBAAWhB,MAAM,CAACiB,UANL;AAOb,oBAAYjB,MAAM,CAACI,WAPN;AAQb,sBAAcJ,MAAM,CAACK;AARR,OAAjB,CANJ,CAgBI;AACA;AACA;AACA;AACA;AACA;;AACAa,MAAAA,aAAa,CAACC,SAAd,CAAwBT,KAAxB,EAA+BE,QAA/B,EAAyCD,OAAzC,EAAkDS,IAAlD,CAAuD,MAAMC,KAAK,CAAC,sBAAD,CAAlE,EAtBJ,CAuBI;;AACA,aAAO5B,OAAP;;AAEJ,SAAK,aAAL;AACI;AACAA,MAAAA,OAAO,CAACC,KAAR,GAAgB,KAAhB;AACAD,MAAAA,OAAO,CAACG,MAAR,GAAiB,KAAjB;AACAH,MAAAA,OAAO,CAACI,QAAR,GAAmB,KAAnB;AACAN,MAAAA,iBAAiB;AACjB,aAAOE,OAAP;;AAGJ;AACI;AACA,aAAOM,KAAP;AAzDR;AA2DH,CA5DM","sourcesContent":["import {items} from \"./../../Stitch/mongodb\";\r\nimport {\r\n   loginUser,\r\n   registerUser,\r\n   hasLoggedInUser,\r\n   logoutCurrentUser,\r\n    getCurrentUser\r\n} from \"./../../Stitch/authentication\";\r\n\r\n\r\n\r\nconst myState = {\r\n    check: hasLoggedInUser(),\r\n    currentuser: getCurrentUser(),\r\n    dealer: false,\r\n    customer: false\r\n}\r\n\r\nexport const userReducer =  (state = myState, action) => {\r\n    switch (action.type) {\r\n\r\n        case 'REGISTER_USER':\r\n            myState.dealer = action.dealer;\r\n            myState.customer = action.customer;\r\n            const new_reg_user = {\r\n                \"email\": action.user_email,\r\n                \"isAdmin\": false,\r\n                \"isDealer\": action.user_dealer,\r\n                \"isCustomer\": action.user_customer\r\n            }\r\n            items.insertOne(new_reg_user);\r\n            registerUser(action.email, action.password);  \r\n            return state;\r\n        \r\n        case 'LOGIN_USER':\r\n            myState.check = action.isLogIn;        \r\n            loginUser(action.email,action.password);          \r\n            return myState;\r\n\r\n        case 'UPDATE_PROFILE':\r\n            //quering the user whose profile is to be updated.\r\n            const query = { \"email\": action.user_email };\r\n            //upsert when true add a new doc if the above query runs false\r\n            const options = {\"upsert\": true};\r\n            //the data to be updated or added\r\n            const new_user = {\r\n                \"owner_id\": myState.currentuser.id,\r\n                \"name\": action.user_name,\r\n                \"email\": action.user_email,\r\n                \"age\": action.user_age,\r\n                \"bio\": action.user_bio,\r\n                \"isAdmin\": action.user_admin,\r\n                \"isDealer\": action.user_dealer,\r\n                \"isCustomer\": action.user_customer\r\n            }\r\n            // if(action.user_dealer){\r\n            //     dealerDetails.updateOne(query, new_user, options).then(() => alert(\"User Profile Updated\"));\r\n            // }\r\n            // else{\r\n            //     customerDetails.updateOne(query, new_user, options).then(() => alert(\"User Profile Updated\"));\r\n            // }\r\n            dealerDetails.updateOne(query, new_user, options).then(() => alert(\"User Profile Updated\"));\r\n            //items.insertOne(new_user).then(() => alert(\"User Profile Updated\"));\r\n            return myState;\r\n\r\n        case 'LOGOUT_USER':\r\n            //updating the state\r\n            myState.check = false;\r\n            myState.dealer = false;\r\n            myState.customer = false;\r\n            logoutCurrentUser();\r\n            return myState;\r\n            \r\n       \r\n        default:\r\n            //returning previous state\r\n            return state;\r\n    }   \r\n}"]},"metadata":{},"sourceType":"module"}